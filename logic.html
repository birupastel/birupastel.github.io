<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multimedia Pembelajaran Logika Proposisi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Plus Jakarta Sans', sans-serif; }
        .fade-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .wire-flow { stroke-dasharray: 10; animation: flow 1s linear infinite; }
        @keyframes flow { to { stroke-dashoffset: -20; } }
        .sidebar-item.active { @apply bg-indigo-600 text-white shadow-lg shadow-indigo-200; }
        .sidebar-item.inactive { @apply text-slate-400 hover:bg-slate-50 hover:text-slate-600; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900 min-h-screen">

    <div class="flex flex-col md:flex-row min-h-screen">
        <!-- Sidebar -->
        <aside id="sidebar" class="hidden md:flex w-72 flex-col bg-white border-r border-slate-200 p-8 shrink-0 fixed inset-y-0 left-0 z-50">
            <div class="flex items-center gap-3 mb-12">
                <div class="w-10 h-10 bg-indigo-600 rounded-xl flex items-center justify-center text-white font-bold text-xl shadow-lg shadow-indigo-100">L</div>
                <span class="font-black text-xl tracking-tighter italic uppercase">Logika</span>
            </div>
            <nav class="flex-1 space-y-2" id="nav-container">
                <!-- Nav items generated via JS -->
            </nav>
            <div class="mt-auto p-5 bg-slate-50 rounded-2xl border border-slate-100">
                <p class="text-[10px] text-slate-400 font-bold uppercase mb-2">Kurikulum Digital</p>
                <div class="h-1.5 w-full bg-slate-200 rounded-full overflow-hidden">
                    <div id="progress-bar" class="h-full bg-indigo-500 transition-all duration-500" style="width: 20%"></div>
                </div>
            </div>
        </aside>

        <!-- Mobile Header -->
        <header class="md:hidden bg-white border-b border-slate-200 p-4 flex items-center justify-between sticky top-0 z-50">
            <span class="font-black text-xl text-indigo-600 italic uppercase">Logika</span>
            <button id="menu-toggle" class="p-2 text-slate-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="3" y1="12" x2="21" y2="12"></line><line x1="3" y1="6" x2="21" y2="6"></line><line x1="3" y1="18" x2="21" y2="18"></line></svg>
            </button>
        </header>

        <!-- Main Content -->
        <main class="flex-1 md:ml-72 p-6 md:p-12 lg:p-16">
            <div id="content-area" class="max-w-5xl mx-auto">
                <!-- Content injected here -->
            </div>
        </main>
    </div>

    <!-- JavaScript -->
    <script>
        // --- DATA & STATE ---
        let activeTab = 'pengantar';
        let currentIntroIdx = 0;
        let introQuizFinished = false;
        let introFeedback = null;
        let userTableAnswers = {};
        let showTableFeedback = false;
        let gateQuestionType = 0;
        let currentCircuit = null;
        let userInputs = [];
        let userGates = [];
        let userOutput = null;
        let gateFeedback = null;
        let isFlowing = false;

        const navItems = [
            { id: 'pengantar', label: 'Pengantar', icon: 'book-open' },
            { id: 'operator', label: 'Operator Logika', icon: 'info' },
            { id: 'playground', label: 'Playground Tabel', icon: 'table' },
            { id: 'gerbang', label: 'Gerbang Logika', icon: 'cpu' },
            { id: 'kuis', label: 'Evaluasi Akhir', icon: 'help-circle' }
        ];

        const introQuestions = [
            { text: "Matahari terbit dari timur", isProp: true, reason: "Ini adalah fakta objektif yang bernilai Benar." },
            { text: "Ambilkan aku segelas air!", isProp: false, reason: "Ini adalah kalimat perintah, bukan pernyataan." },
            { text: "x + 5 = 10", isProp: false, reason: "Ini kalimat terbuka. Nilainya belum pasti sampai x diketahui." },
            { text: "5 adalah bilangan prima", isProp: true, reason: "Ini pernyataan matematika yang bernilai Benar." }
        ];

        // --- UTILS ---
        const $ = (id) => document.getElementById(id);
        const iconMap = {
            'book-open': '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M2 3h6a4 4 0 014 4v14a4 4 0 00-4-4H2zM22 3h-6a4 4 0 00-4 4v14a4 4 0 014-4h6z"></path></svg>',
            'info': '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="16" x2="12" y2="12"></line><line x1="12" y1="8" x2="12.01" y2="8"></line></svg>',
            'table': '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="3" y1="15" x2="21" y2="15"></line><line x1="9" y1="3" x2="9" y2="21"></line><line x1="15" y1="3" x2="15" y2="21"></line></svg>',
            'cpu': '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><rect x="4" y="4" width="16" height="16" rx="2"/><rect x="9" y="9" width="6" height="6"/><path d="M15 2v2M15 20v2M9 2v2M9 20v2M20 15h2M2 15h2M20 9h2M2 9h2"/></svg>',
            'help-circle': '<svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10"></circle><path d="M9.09 9a3 3 0 015.83 1c0 2-3 3-3 3"></path><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'
        };

        // --- CIRCUIT GENERATOR ---
        function generateCircuit() {
            const types = ['balanced', 'chain', 'hybrid'];
            const type = types[Math.floor(Math.random() * types.length)];
            const qType = Math.floor(Math.random() * 3);
            let nodes = [], conns = [];

            if (type === 'balanced') {
                nodes = [
                    { id: 'i1', type: 'input', val: Math.round(Math.random()), x: 50, y: 50 },
                    { id: 'i2', type: 'input', val: Math.round(Math.random()), x: 50, y: 120 },
                    { id: 'i3', type: 'input', val: Math.round(Math.random()), x: 50, y: 250 },
                    { id: 'i4', type: 'input', val: Math.round(Math.random()), x: 50, y: 320 },
                    { id: 'g1', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 250, y: 65 },
                    { id: 'g2', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 250, y: 265 },
                    { id: 'g3', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 500, y: 165 },
                    { id: 'out', type: 'output', x: 700, y: 175 }
                ];
                conns = [
                    { from: 'i1', to: 'g1' }, { from: 'i2', to: 'g1' },
                    { from: 'i3', to: 'g2' }, { from: 'i4', to: 'g2' },
                    { from: 'g1', to: 'g3' }, { from: 'g2', to: 'g3' },
                    { from: 'g3', to: 'out' }
                ];
            } else if (type === 'chain') {
                nodes = [
                    { id: 'i1', type: 'input', val: Math.round(Math.random()), x: 50, y: 50 },
                    { id: 'i2', type: 'input', val: Math.round(Math.random()), x: 50, y: 120 },
                    { id: 'i3', type: 'input', val: Math.round(Math.random()), x: 200, y: 220 },
                    { id: 'g1', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 220, y: 65 },
                    { id: 'g2', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 450, y: 130 },
                    { id: 'out', type: 'output', x: 700, y: 140 }
                ];
                conns = [
                    { from: 'i1', to: 'g1' }, { from: 'i2', to: 'g1' },
                    { from: 'g1', to: 'g2' }, { from: 'i3', to: 'g2' },
                    { from: 'g2', to: 'out' }
                ];
            } else {
                nodes = [
                    { id: 'i1', type: 'input', val: Math.round(Math.random()), x: 50, y: 80 },
                    { id: 'i2', type: 'input', val: Math.round(Math.random()), x: 50, y: 250 },
                    { id: 'n1', type: 'gate', op: 'NOT', x: 220, y: 70 },
                    { id: 'g1', type: 'gate', op: ['AND', 'OR'][Math.round(Math.random())], x: 450, y: 150 },
                    { id: 'out', type: 'output', x: 700, y: 160 }
                ];
                conns = [
                    { from: 'i1', to: 'n1' }, { from: 'n1', to: 'g1' }, { from: 'i2', to: 'g1' }, { from: 'g1', to: 'out' }
                ];
            }

            currentCircuit = { type, nodes, conns };
            gateQuestionType = qType;
            userInputs = nodes.filter(n => n.type === 'input').map(n => n.val);
            userGates = nodes.filter(n => n.type === 'gate').map(n => n.op);
            userOutput = null;
            gateFeedback = null;
            isFlowing = false;
            render();
        }

        function calculateCircuit(inputs, gates) {
            let values = {};
            currentCircuit.nodes.filter(n => n.type === 'input').forEach((n, i) => values[n.id] = inputs[i]);
            currentCircuit.nodes.filter(n => n.type === 'gate').forEach((node, idx) => {
                const op = gates[idx];
                const incoming = currentCircuit.conns.filter(c => c.to === node.id).map(c => values[c.from]);
                if (op === 'AND') values[node.id] = incoming.every(v => v === 1) ? 1 : 0;
                else if (op === 'OR') values[node.id] = incoming.some(v => v === 1) ? 1 : 0;
                else if (op === 'NOT') values[node.id] = incoming[0] === 1 ? 0 : 1;
            });
            const outNode = currentCircuit.nodes.find(n => n.type === 'output');
            const finalNodeId = currentCircuit.conns.find(c => c.to === outNode.id).from;
            return values[finalNodeId];
        }

        // --- RENDER ENGINE ---
        function render() {
            renderSidebar();
            const area = $('content-area');
            area.innerHTML = '';

            const wrapper = document.createElement('div');
            wrapper.className = 'fade-in';

            if (activeTab === 'pengantar') renderPengantar(wrapper);
            else if (activeTab === 'operator') renderOperator(wrapper);
            else if (activeTab === 'playground') renderPlayground(wrapper);
            else if (activeTab === 'gerbang') renderGerbang(wrapper);
            else if (activeTab === 'kuis') renderKuis(wrapper);

            area.appendChild(wrapper);
            $('progress-bar').style.width = `${(navItems.findIndex(i => i.id === activeTab) + 1) * 20}%`;
        }

        function renderSidebar() {
            const container = $('nav-container');
            container.innerHTML = '';
            navItems.forEach(item => {
                const btn = document.createElement('button');
                btn.className = `w-full flex items-center gap-4 px-5 py-4 rounded-2xl font-bold transition-all ${activeTab === item.id ? 'sidebar-item active' : 'sidebar-item inactive'}`;
                btn.innerHTML = `${iconMap[item.icon]} <span>${item.label}</span>`;
                btn.onclick = () => { activeTab = item.id; render(); };
                container.appendChild(btn);
            });
        }

        function renderPengantar(container) {
            container.innerHTML = `
                <h2 class="text-3xl font-bold text-slate-800 mb-6">Apa itu Logika Proposisi?</h2>
                <div class="bg-white p-8 rounded-3xl border border-slate-200 shadow-sm mb-8 space-y-4 text-slate-600">
                    <p>Logika proposisi adalah studi tentang pernyataan yang memiliki satu nilai kebenaran mutlak: <strong>Benar (T)</strong> atau <strong>Salah (F)</strong>.</p>
                    <div class="grid md:grid-cols-2 gap-4 my-6">
                        <div class="bg-emerald-50 p-4 rounded-xl border border-emerald-100 text-sm">
                            <span class="font-bold text-emerald-800 block mb-1">✓ Proposisi</span>
                            "Jakarta adalah ibu kota Indonesia." (Benar)
                        </div>
                        <div class="bg-rose-50 p-4 rounded-xl border border-rose-100 text-sm">
                            <span class="font-bold text-rose-800 block mb-1">✗ Bukan Proposisi</span>
                            "Tutup pintunya!" (Perintah)
                        </div>
                    </div>
                </div>
                <div class="bg-indigo-50/50 p-8 rounded-3xl border border-indigo-100">
                    <h3 class="text-xl font-bold mb-6">Cek Pemahaman Cepat</h3>
                    ${!introQuizFinished ? `
                        <div class="bg-white p-8 rounded-2xl border border-slate-200">
                            <p class="text-lg font-medium text-slate-700 mb-8 italic">"${introQuestions[currentIntroIdx].text}"</p>
                            ${!introFeedback ? `
                                <div class="grid grid-cols-2 gap-4">
                                    <button onclick="handleIntro(true)" class="p-4 rounded-xl border-2 hover:border-indigo-500 font-bold transition-all">Proposisi</button>
                                    <button onclick="handleIntro(false)" class="p-4 rounded-xl border-2 hover:border-indigo-500 font-bold transition-all">Bukan</button>
                                </div>
                            ` : `
                                <div class="p-6 rounded-xl ${introFeedback.isCorrect ? 'bg-emerald-50 text-emerald-700' : 'bg-rose-50 text-rose-700'}">
                                    <p class="font-bold mb-2">${introFeedback.isCorrect ? 'Tepat!' : 'Kurang Tepat'}</p>
                                    <p class="text-sm opacity-80 mb-6">${introQuestions[currentIntroIdx].reason}</p>
                                    <button onclick="nextIntro()" class="w-full bg-slate-800 text-white py-3 rounded-xl font-bold">Lanjut</button>
                                </div>
                            `}
                        </div>
                    ` : `<div class="text-center p-10 font-bold text-indigo-600">Latihan Selesai! Kamu siap lanjut ke operator.</div>`}
                </div>
            `;
        }

        function handleIntro(val) {
            introFeedback = { isCorrect: val === introQuestions[currentIntroIdx].isProp };
            render();
        }

        function nextIntro() {
            introFeedback = null;
            if (currentIntroIdx < introQuestions.length - 1) currentIntroIdx++;
            else introQuizFinished = true;
            render();
        }

        function renderOperator(container) {
            const operators = [
                { n: 'Negasi (¬)', t: [{p:1,r:0},{p:0,r:1}], c: 'bg-slate-800 text-white' },
                { n: 'Konjungsi (∧)', t: [{p:1,q:1,r:1},{p:1,q:0,r:0},{p:0,q:1,r:0},{p:0,q:0,r:0}], c: 'bg-emerald-50 text-emerald-600' },
                { n: 'Disjungsi (∨)', t: [{p:1,q:1,r:1},{p:1,q:0,r:1},{p:0,q:1,r:1},{p:0,q:0,r:0}], c: 'bg-amber-50 text-amber-600' },
                { n: 'Implikasi (→)', t: [{p:1,q:1,r:1},{p:1,q:0,r:0},{p:0,q:1,r:1},{p:0,q:0,r:1}], c: 'bg-indigo-50 text-indigo-600' },
                { n: 'Bi-implikasi (↔)', t: [{p:1,q:1,r:1},{p:1,q:0,r:0},{p:0,q:1,r:0},{p:0,q:0,r:1}], c: 'bg-rose-50 text-rose-600' }
            ];
            container.innerHTML = `<h2 class="text-3xl font-bold text-slate-800 mb-6">Tabel Operator Logika</h2><div class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">` +
                operators.map(op => `
                    <div class="bg-white p-6 rounded-3xl border border-slate-200 shadow-sm">
                        <h3 class="font-black text-center p-2 rounded-lg mb-4 ${op.c}">${op.n}</h3>
                        <table class="w-full text-center text-xs">
                            <thead><tr class="text-slate-400"><th>p</th>${op.t[0].q !== undefined ? '<th>q</th>' : ''}<th>H</th></tr></thead>
                            <tbody>${op.t.map(r => `<tr class="border-t border-slate-50"><td>${r.p?'T':'F'}</td>${r.q !== undefined ? `<td>${r.q?'T':'F'}</td>` : ''}<td class="font-bold">${r.r?'T':'F'}</td></tr>`).join('')}</tbody>
                        </table>
                    </div>
                `).join('') + `</div>`;
        }

        function renderPlayground(container) {
            const rows = [
                {p:true,q:true,nq:false,inner:true,res:true},
                {p:true,q:false,nq:true,inner:true,res:true},
                {p:false,q:true,nq:false,inner:false,res:true},
                {p:false,q:false,nq:true,inner:true,res:false}
            ];
            container.innerHTML = `
                <h2 class="text-2xl font-bold mb-6">Playground Tabel Kebenaran</h2>
                <div class="bg-slate-900 p-8 rounded-3xl text-white text-center font-mono font-bold mb-8 shadow-xl">
                    <span class="text-indigo-400 text-xs block mb-2 opacity-60">SOAL:</span> p ↔ (¬q ∨ p)
                </div>
                <div class="bg-white rounded-3xl border border-slate-200 overflow-x-auto">
                    <table class="w-full text-center min-w-[500px]">
                        <thead class="bg-slate-50 text-[10px] text-slate-400 font-black uppercase">
                            <tr><th class="p-4">p</th><th class="p-4">q</th><th class="p-4">¬q</th><th class="p-4">¬q ∨ p</th><th class="p-4 bg-indigo-50 text-indigo-600">HASIL</th></tr>
                        </thead>
                        <tbody>
                            ${rows.map((row, rIdx) => `
                                <tr class="border-t border-slate-100">
                                    <td class="p-4 text-slate-400 font-bold">${row.p?'T':'F'}</td>
                                    <td class="p-4 text-slate-400 font-bold">${row.q?'T':'F'}</td>
                                    ${['nq', 'inner', 'res'].map(col => {
                                        const key = `${rIdx}-${col}`;
                                        const val = userTableAnswers[key];
                                        const correct = row[col];
                                        return `<td class="p-4">
                                            <button onclick="toggleTable('${key}')" class="w-10 h-10 rounded-xl font-bold border-2 transition-all ${val === undefined ? 'bg-slate-50 text-slate-200' : val ? 'border-emerald-500 text-emerald-500' : 'border-rose-500 text-rose-500'}">
                                                ${val === undefined ? '?' : val ? 'T' : 'F'}
                                            </button>
                                            ${showTableFeedback && val !== undefined ? `<div class="text-[8px] font-bold ${val === correct ? 'text-emerald-500':'text-rose-500'}">${val === correct ? 'BENAR':'SALAH'}</div>` : ''}
                                        </td>`;
                                    }).join('')}
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
                <button onclick="checkTable()" class="w-full mt-6 bg-indigo-600 text-white py-4 rounded-2xl font-bold shadow-lg shadow-indigo-100">Cek Semua Jawaban</button>
            `;
        }

        function toggleTable(key) {
            const val = userTableAnswers[key];
            userTableAnswers[key] = val === undefined ? true : val === true ? false : undefined;
            showTableFeedback = false;
            render();
        }
        function checkTable() { showTableFeedback = true; render(); }

        function renderGerbang(container) {
            if (!currentCircuit) { generateCircuit(); return; }
            container.innerHTML = `
                <div class="flex justify-between items-center gap-4 mb-8">
                    <div>
                        <h2 class="text-2xl font-bold">Dinamika Gerbang Logika</h2>
                        <p class="text-slate-500 text-xs">${['Cari Output (?)', 'Cari Operator Gerbang', 'Cari Nilai Input'][gateQuestionType]}</p>
                    </div>
                    <div class="flex gap-2">
                        <button onclick="checkGate()" class="bg-indigo-600 text-white px-6 py-3 rounded-2xl font-bold shadow-lg shadow-indigo-100 flex items-center gap-2 transition-all"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"/></svg> Cek</button>
                        <button onclick="generateCircuit()" class="bg-white border border-slate-200 text-slate-600 p-3 rounded-2xl font-bold hover:bg-slate-50"><svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/></svg></button>
                    </div>
                </div>
                <div class="bg-white p-4 md:p-12 rounded-[40px] border border-slate-200 shadow-sm relative overflow-hidden">
                    <svg viewBox="0 0 800 400" class="w-full h-auto">
                        ${currentCircuit.conns.map(conn => {
                            const f = currentCircuit.nodes.find(n => n.id === conn.from);
                            const t = currentCircuit.nodes.find(n => n.id === conn.to);
                            const sx = f.type === 'input' ? f.x + 40 : f.x + 100;
                            const sy = f.type === 'input' ? f.y : f.y + 40;
                            const ex = t.x;
                            const ey = t.type === 'output' ? t.y + 30 : t.y + 40;
                            const mx = (sx + ex) / 2;
                            const d = `M ${sx} ${sy} C ${mx} ${sy}, ${mx} ${ey}, ${ex} ${ey}`;
                            return `<path d="${d}" class="stroke-slate-200 fill-none stroke-[4] transition-all ${isFlowing ? 'stroke-indigo-400 wire-flow stroke-[6]' : ''}" />`;
                        }).join('')}
                        ${currentCircuit.nodes.map(node => {
                            if (node.type === 'input') {
                                const idx = currentCircuit.nodes.filter(n => n.type === 'input').indexOf(node);
                                const isQ = gateQuestionType === 2;
                                return `<g class="cursor-pointer" onclick="toggleGateInput(${idx})">
                                    <rect x="${node.x}" y="${node.y-20}" width="40" height="40" rx="10" class="${isQ ? (userInputs[idx] ? 'fill-indigo-600' : 'fill-slate-200') : (node.val ? 'fill-indigo-600' : 'fill-slate-800')}" />
                                    <text x="${node.x+20}" y="${node.y+7}" textAnchor="middle" class="fill-white font-bold text-xl">${isQ ? userInputs[idx] : node.val}</text>
                                </g>`;
                            }
                            if (node.type === 'gate') {
                                const idx = currentCircuit.nodes.filter(n => n.type === 'gate').indexOf(node);
                                const isQ = gateQuestionType === 1 && node.op !== 'NOT';
                                return `<g class="cursor-pointer" onclick="toggleGateOp(${idx})">
                                    <rect x="${node.x}" y="${node.y}" width="100" height="80" rx="20" class="${node.op === 'NOT' ? 'fill-slate-800' : 'fill-emerald-500'}" />
                                    <text x="${node.x+50}" y="${node.y+48}" textAnchor="middle" class="fill-white font-black text-lg">${isQ ? userGates[idx] : node.op}</text>
                                </g>`;
                            }
                            if (node.type === 'output') {
                                const isQ = gateQuestionType === 0;
                                return `<g class="cursor-pointer" onclick="toggleGateOut()">
                                    <rect x="${node.x}" y="${node.y}" width="60" height="60" rx="15" class="${isQ && userOutput === null ? 'fill-slate-100' : 'fill-slate-900'}" />
                                    <text x="${node.x+30}" y="${node.y+38}" textAnchor="middle" class="fill-white font-black text-2xl">${isQ ? (userOutput === null ? '?' : userOutput) : calculateCircuit(currentCircuit.nodes.filter(n => n.type === 'input').map(n => n.val), currentCircuit.nodes.filter(n => n.type === 'gate').map(n => n.op))}</text>
                                </g>`;
                            }
                            return '';
                        }).join('')}
                    </svg>
                    ${gateFeedback ? `<div class="absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 px-8 py-4 rounded-full font-black text-white shadow-2xl ${gateFeedback === 'correct' ? 'bg-emerald-500' : 'bg-rose-500'}">${gateFeedback === 'correct' ? 'BENAR!' : 'COBA LAGI'}</div>` : ''}
                </div>
            `;
        }

        function toggleGateInput(i) { if (gateQuestionType === 2) { userInputs[i] = userInputs[i] === 1 ? 0 : 1; render(); } }
        function toggleGateOp(i) { if (gateQuestionType === 1) { userGates[i] = userGates[i] === 'AND' ? 'OR' : 'AND'; render(); } }
        function toggleGateOut() { if (gateQuestionType === 0) { userOutput = userOutput === 1 ? 0 : 1; render(); } }
        function checkGate() {
            const correctVal = calculateCircuit(currentCircuit.nodes.filter(n => n.type === 'input').map(n => n.val), currentCircuit.nodes.filter(n => n.type === 'gate').map(n => n.op));
            let userVal;
            if (gateQuestionType === 0) userVal = userOutput;
            else if (gateQuestionType === 1) userVal = calculateCircuit(currentCircuit.nodes.filter(n => n.type === 'input').map(n => n.val), userGates);
            else if (gateQuestionType === 2) userVal = calculateCircuit(userInputs, currentCircuit.nodes.filter(n => n.type === 'gate').map(n => n.op));
            isFlowing = true;
            gateFeedback = userVal === correctVal ? 'correct' : 'wrong';
            render();
            setTimeout(() => { isFlowing = false; render(); }, 3000);
        }

        function renderKuis(container) {
            container.innerHTML = `
                <div class="animate-fadeIn max-w-xl mx-auto text-center space-y-8">
                    <h2 class="text-3xl font-bold">Evaluasi Akhir</h2>
                    <div class="bg-white p-10 rounded-3xl border border-slate-200 shadow-sm">
                        <p class="text-lg italic mb-10">"Jika p=1, q=0, berapa hasil dari (p ∧ q) ∨ (¬q ∧ p)?"</p>
                        <div class="grid grid-cols-2 gap-4">
                            <button onclick="alert('Luar biasa! Jawabanmu Benar (1)')" class="p-4 rounded-xl border-2 font-bold hover:bg-emerald-50 transition-all">1 (Benar)</button>
                            <button onclick="alert('Hampir tepat! Ayo tinjau tabel kebenaran lagi.')" class="p-4 rounded-xl border-2 font-bold hover:bg-rose-50 transition-all">0 (Salah)</button>
                        </div>
                    </div>
                </div>
            `;
        }

        // --- INIT ---
        window.onload = () => {
            render();
            $('menu-toggle').onclick = () => {
                const sidebar = $('sidebar');
                sidebar.classList.toggle('hidden');
                sidebar.classList.toggle('flex');
            };
        };
    </script>
</body>
</html>
