<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simulasi Sinyal</title>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-pastel: #f8f9fa;
            --blue-pastel: #e3f2fd;
            --green-pastel: #e8f5e9;
            --lavender-pastel: #f3e5f5;
            --cream-pastel: #fff9c4;
            --primary: #5c6bc0;
            --text-dark: #2c3e50;
            --card-shadow: 0 8px 30px rgba(0,0,0,0.05);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
            font-family: 'Poppins', sans-serif;
        }

        body {
            background-color: var(--bg-pastel);
            color: var(--text-dark);
            line-height: 1.6;
            padding-bottom: 50px;
        }

        header {
            background-color: white;
            padding: 2rem;
            text-align: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 2rem;
        }

        header h1 {
            color: var(--primary);
            font-weight: 600;
            font-size: 1.8rem;
        }

        header p {
            font-size: 0.9rem;
            opacity: 0.7;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 0 1rem;
        }

        /* Tabs Interface */
        .tabs {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 2rem;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 24px;
            border: none;
            background: white;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 500;
            transition: all 0.3s ease;
            box-shadow: var(--card-shadow);
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--text-dark);
        }

        .tab-btn.active {
            background: var(--primary);
            color: white;
        }

        .tab-btn:hover:not(.active) {
            transform: translateY(-2px);
            background: var(--blue-pastel);
        }

        /* Content Sections */
        .tab-content {
            display: none;
            animation: fadeIn 0.4s ease;
        }

        .tab-content.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Cards and Layout */
        .card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--card-shadow);
        }

        .grid-2 {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1.5rem;
        }

        @media (max-width: 768px) {
            .grid-2 { grid-template-columns: 1fr; }
        }

        /* Controls */
        .control-group {
            margin-bottom: 1.2rem;
        }

        label {
            display: block;
            font-size: 0.85rem;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #666;
        }

        input[type="range"] {
            width: 100%;
            accent-color: var(--primary);
        }

        input[type="text"] {
            width: 100%;
            padding: 10px 15px;
            border: 2px solid #eee;
            border-radius: 10px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus {
            border-color: var(--primary);
        }

        button.btn-primary {
            background: var(--primary);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 10px;
            cursor: pointer;
            font-weight: 500;
            width: 100%;
            transition: opacity 0.3s;
        }

        button.btn-primary:hover {
            opacity: 0.9;
        }

        /* Canvas Style */
        canvas {
            width: 100%;
            height: 200px;
            background: #fafafa;
            border-radius: 12px;
            border: 1px solid #eee;
            margin-top: 10px;
        }

        .encoding-label {
            font-weight: 600;
            margin-top: 1rem;
            display: block;
            color: var(--primary);
        }

        .encoding-desc {
            font-size: 0.8rem;
            color: #777;
            margin-top: 4px;
            background: #fdfdfd;
            padding: 8px;
            border-radius: 6px;
        }

        /* Noise Lab Specifics */
        .noise-status {
            text-align: center;
            padding: 1rem;
            border-radius: 12px;
            margin-top: 1rem;
            font-weight: 600;
        }

        .status-ok { background: var(--green-pastel); color: #2e7d32; }
        .status-error { background: #ffebee; color: #c62828; }

        .accuracy-pill {
            display: inline-block;
            padding: 4px 12px;
            background: var(--lavender-pastel);
            border-radius: 20px;
            font-size: 0.8rem;
            margin-top: 5px;
        }

        .mode-selector {
            display: flex;
            gap: 1rem;
            margin-bottom: 1rem;
        }

        .radio-btn {
            display: flex;
            align-items: center;
            gap: 5px;
            cursor: pointer;
        }

        /* Education Box */
        .edu-box {
            margin-top: 1.5rem;
            padding: 1rem;
            border-left: 4px solid var(--primary);
            background: var(--blue-pastel);
            border-radius: 0 12px 12px 0;
            font-size: 0.9rem;
        }

        .edu-box h4 {
            margin-bottom: 0.5rem;
            color: var(--primary);
        }

    </style>
</head>
<body>

    <header>
        <h1>Simulasi Sinyal</h1>
        <p>Eksplorasi Interaktif Sinyal dan Transmisi Data</p>
    </header>

    <div class="container">
        <!-- Tab Navigation -->
        <div class="tabs">
            <button class="tab-btn active" onclick="openTab('mode1')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>
                Dasar Sinyal
            </button>
            <button class="tab-btn" onclick="openTab('mode2')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2"/><path d="M8 21h8"/><path d="M12 17v4"/></svg>
                Encoding Data
            </button>
            <button class="tab-btn" onclick="openTab('mode3')">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M2 10s3-3 3-8"/><path d="M22 10s-3-3-3-8"/><path d="M10 2c1 2 2.5 4 3 7 1 3 0 6-5 9-3 3-3 6 0 6s7-1 10-5c2-3 3-6 1-10"/><circle cx="12" cy="12" r="10"/></svg>
                Ketahanan Sinyal
            </button>
        </div>

        <!-- Mode 1: Dasar Sinyal -->
        <div id="mode1" class="tab-content active">
            <div class="grid-2">
                <div class="card">
                    <h3>Sinyal Analog (Sinus)</h3>
                    <div class="control-group">
                        <label>Amplitudo: <span id="amp-val">5</span></label>
                        <input type="range" id="input-amp" min="1" max="10" step="0.5" value="5">
                    </div>
                    <div class="control-group">
                        <label>Frekuensi: <span id="freq-val">1.0</span> Hz</label>
                        <input type="range" id="input-freq" min="0.1" max="5" step="0.1" value="1">
                    </div>
                    <canvas id="canvas-analog"></canvas>
                </div>
                <div class="card">
                    <h3>Sinyal Digital (Square)</h3>
                    <div class="control-group">
                        <label>Input Biner (8-16 bit)</label>
                        <input type="text" id="binary-input-basic" value="10101101" maxlength="16">
                    </div>
                    <button class="btn-primary" onclick="generateBasicDigital()">Generate Wave</button>
                    <canvas id="canvas-digital"></canvas>
                </div>
            </div>
        </div>

        <!-- Mode 2: Encoding Lab -->
        <div id="mode2" class="tab-content">
            <div class="card">
                <h3>Encoding & Data Representation</h3>
                <div class="control-group" style="max-width: 400px;">
                    <label>Input Biner Sentral</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="binary-input-encode" value="10110010" maxlength="16">
                        <button class="btn-primary" style="width: auto;" onclick="runEncoding()">Encode</button>
                    </div>
                </div>

                <div>
                    <span class="encoding-label">Unipolar Encoding</span>
                    <canvas id="canvas-unipolar"></canvas>
                    <p class="encoding-desc"><strong>Unipolar:</strong> Tegangan hanya satu polaritas (biasanya positif). Rentan terhadap akumulasi komponen DC.</p>
                </div>

                <div>
                    <span class="encoding-label">Polar (NRZ-L) Encoding</span>
                    <canvas id="canvas-polar"></canvas>
                    <p class="encoding-desc"><strong>Polar:</strong> Menggunakan dua level tegangan (positif dan negatif). Mengurangi masalah komponen DC dibanding unipolar.</p>
                </div>

                <div>
                    <span class="encoding-label">Bipolar (AMI) Encoding</span>
                    <canvas id="canvas-bipolar"></canvas>
                    <p class="encoding-desc"><strong>Bipolar (AMI):</strong> Angka '0' pada tegangan nol, '1' bergantian antara positif dan negatif. Membantu sinkronisasi.</p>
                </div>
            </div>
        </div>

        <!-- Mode 3: Noise Lab -->
        <div id="mode3" class="tab-content">
            <div class="card">
                <h3>Uji Ketahanan Terhadap Noise</h3>
                <div class="grid-2">
                    <div>
                        <label>Pilihan Transmisi</label>
                        <div class="mode-selector">
                            <label class="radio-btn">
                                <input type="radio" name="trans-type" value="analog" checked onchange="updateNoiseLab()"> Analog
                            </label>
                            <label class="radio-btn">
                                <input type="radio" name="trans-type" value="digital" onchange="updateNoiseLab()"> Digital (Polar)
                            </label>
                        </div>
                        <div class="control-group">
                            <label>Tingkat Noise: <span id="noise-val">0</span>%</label>
                            <input type="range" id="input-noise" min="0" max="100" value="0" oninput="updateNoiseLab()">
                        </div>
                    </div>
                    <div style="text-align: center; border-left: 1px solid #eee; padding-left: 1rem;">
                        <label>Indikator Penerimaan</label>
                        <div id="noise-indicator" class="noise-status status-ok">
                            Data Diterima Akurat!
                        </div>
                        <div class="accuracy-pill">Akurasi: <span id="accuracy-text">100</span>%</div>
                    </div>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-top: 1rem; font-size: 0.75rem; color: #999;">
                    <span>PENGIRIM</span>
                    <span>AREA GANGGUAN</span>
                    <span>PENERIMA</span>
                </div>
                <canvas id="canvas-noise" style="height: 300px;"></canvas>

                <!-- Penjelasan Edukatif -->
                <div id="noise-explanation" class="edu-box">
                    <h4 id="edu-title">Karakteristik Sinyal Analog</h4>
                    <p id="edu-text">Sinyal analog mengalami degradasi secara bertahap. Semakin tinggi noise, semakin buruk kualitas informasi yang diterima (misal: suara semakin berdesis), namun sinyal tidak langsung hilang sepenuhnya.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // --- Global State ---
        let currentTab = 'mode1';
        let analogAmp = 5;
        let analogFreq = 1;
        let basicBinary = "10101101";
        let encodeBinary = "10110010";
        let noiseLevel = 0;

        // --- Initialization ---
        window.onload = () => {
            initAnalogMode();
            runEncoding();
            updateNoiseLab();
            
            // Listeners for sliders
            document.getElementById('input-amp').addEventListener('input', (e) => {
                analogAmp = e.target.value;
                document.getElementById('amp-val').innerText = analogAmp;
                drawAnalogWave();
            });

            document.getElementById('input-freq').addEventListener('input', (e) => {
                analogFreq = e.target.value;
                document.getElementById('freq-val').innerText = analogFreq;
                drawAnalogWave();
            });
        };

        // --- Tab Logic ---
        function openTab(tabId) {
            document.querySelectorAll('.tab-content').forEach(el => el.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active'));
            
            document.getElementById(tabId).classList.add('active');
            event.currentTarget.classList.add('active');
            
            if(tabId === 'mode1') {
                drawAnalogWave();
                generateBasicDigital();
            }
            if(tabId === 'mode2') runEncoding();
            if(tabId === 'mode3') updateNoiseLab();
        }

        // --- Drawing Helpers ---
        function clearCanvas(canvas) {
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Draw baseline
            ctx.beginPath();
            ctx.strokeStyle = '#eee';
            ctx.lineWidth = 1;
            ctx.moveTo(0, canvas.height / 2);
            ctx.lineTo(canvas.width, canvas.height / 2);
            ctx.stroke();
        }

        function setupCanvas(id) {
            const canvas = document.getElementById(id);
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            const ctx = canvas.getContext('2d');
            ctx.scale(dpr, dpr);
            return { canvas, ctx, width: rect.width, height: rect.height };
        }

        function drawBitLabel(ctx, bit, x, y) {
            ctx.font = 'bold 12px Poppins';
            ctx.fillStyle = '#999';
            ctx.textAlign = 'center';
            ctx.fillText(bit, x, y);
        }

        // --- Mode 1 Logic ---
        function initAnalogMode() {
            drawAnalogWave();
            generateBasicDigital();
        }

        function drawAnalogWave() {
            const { ctx, width, height } = setupCanvas('canvas-analog');
            clearCanvas(document.getElementById('canvas-analog'));
            
            ctx.beginPath();
            ctx.strokeStyle = '#5c6bc0';
            ctx.lineWidth = 2;

            for (let x = 0; x < width; x++) {
                const y = (height / 2) + (analogAmp * 8) * Math.sin((x / width) * Math.PI * 2 * analogFreq * 5);
                if (x === 0) ctx.moveTo(x, y);
                else ctx.lineTo(x, y);
            }
            ctx.stroke();
        }

        function generateBasicDigital() {
            const input = document.getElementById('binary-input-basic').value;
            if (!/^[01]+$/.test(input)) {
                alert("Masukkan hanya angka 0 dan 1");
                return;
            }
            drawDigitalWave('canvas-digital', input);
        }

        function drawDigitalWave(canvasId, bits) {
            const { ctx, width, height } = setupCanvas(canvasId);
            clearCanvas(document.getElementById(canvasId));

            const step = width / bits.length;
            const high = height * 0.25;
            const low = height * 0.75;

            ctx.beginPath();
            ctx.strokeStyle = '#66bb6a';
            ctx.lineWidth = 3;

            let currentX = 0;
            bits.split('').forEach((bit, i) => {
                const targetY = (bit === '1') ? high : low;
                
                // Indikator teks 1/0
                drawBitLabel(ctx, bit, currentX + step/2, height * 0.15);

                // Vertical line
                if (i > 0) ctx.lineTo(currentX, targetY);
                else ctx.moveTo(currentX, targetY);
                
                // Horizontal line
                currentX += step;
                ctx.lineTo(currentX, targetY);
            });
            ctx.stroke();
        }

        // --- Mode 2 Logic ---
        function runEncoding() {
            const bits = document.getElementById('binary-input-encode').value;
            if (!/^[01]+$/.test(bits)) return;

            drawUnipolar(bits);
            drawPolar(bits);
            drawBipolar(bits);
        }

        function drawUnipolar(bits) {
            const { ctx, width, height } = setupCanvas('canvas-unipolar');
            clearCanvas(document.getElementById('canvas-unipolar'));
            const step = width / bits.length;
            ctx.beginPath();
            ctx.strokeStyle = '#42a5f5';
            ctx.lineWidth = 2;
            let cx = 0;
            bits.split('').forEach((bit, i) => {
                const y = bit === '1' ? height*0.3 : height*0.5;
                drawBitLabel(ctx, bit, cx + step/2, height * 0.15);
                if(i>0) ctx.lineTo(cx, y); else ctx.moveTo(cx, y);
                cx += step;
                ctx.lineTo(cx, y);
            });
            ctx.stroke();
        }

        function drawPolar(bits) {
            const { ctx, width, height } = setupCanvas('canvas-polar');
            clearCanvas(document.getElementById('canvas-polar'));
            const step = width / bits.length;
            ctx.beginPath();
            ctx.strokeStyle = '#ab47bc';
            ctx.lineWidth = 2;
            let cx = 0;
            bits.split('').forEach((bit, i) => {
                const y = bit === '1' ? height*0.3 : height*0.7;
                drawBitLabel(ctx, bit, cx + step/2, height * 0.15);
                if(i>0) ctx.lineTo(cx, y); else ctx.moveTo(cx, y);
                cx += step;
                ctx.lineTo(cx, y);
            });
            ctx.stroke();
        }

        function drawBipolar(bits) {
            const { ctx, width, height } = setupCanvas('canvas-bipolar');
            clearCanvas(document.getElementById('canvas-bipolar'));
            const step = width / bits.length;
            ctx.beginPath();
            ctx.strokeStyle = '#ffa726';
            ctx.lineWidth = 2;
            let cx = 0;
            let lastPolarity = 1; 
            bits.split('').forEach((bit, i) => {
                let y;
                drawBitLabel(ctx, bit, cx + step/2, height * 0.15);
                if (bit === '0') {
                    y = height * 0.5;
                } else {
                    y = lastPolarity === 1 ? height * 0.3 : height * 0.7;
                    lastPolarity *= -1;
                }
                if(i>0) ctx.lineTo(cx, y); else ctx.moveTo(cx, y);
                cx += step;
                ctx.lineTo(cx, y);
            });
            ctx.stroke();
        }

        // --- Mode 3 Logic ---
        function updateNoiseLab() {
            const type = document.querySelector('input[name="trans-type"]:checked').value;
            noiseLevel = document.getElementById('input-noise').value;
            document.getElementById('noise-val').innerText = noiseLevel;

            const { ctx, width, height } = setupCanvas('canvas-noise');
            clearCanvas(document.getElementById('canvas-noise'));

            const noiseIntensity = noiseLevel / 5;
            const indicator = document.getElementById('noise-indicator');
            const accuracyText = document.getElementById('accuracy-text');
            const eduTitle = document.getElementById('edu-title');
            const eduText = document.getElementById('edu-text');

            ctx.beginPath();
            ctx.strokeStyle = type === 'analog' ? '#5c6bc0' : '#ab47bc';
            ctx.lineWidth = 2;

            if (type === 'analog') {
                eduTitle.innerText = "Karakteristik Sinyal Analog";
                eduText.innerText = "Sinyal analog mengalami degradasi secara bertahap. Semakin tinggi noise, semakin buruk kualitas informasi yang diterima (misal: suara semakin berdesis), namun sinyal tidak langsung hilang sepenuhnya.";
                
                for (let x = 0; x < width; x++) {
                    const baseWave = (height / 2) + 40 * Math.sin((x / width) * Math.PI * 10);
                    const localNoise = (x > width*0.3) ? (Math.random() - 0.5) * noiseIntensity * ((x - width*0.3)/(width*0.7)) * 10 : 0;
                    const y = baseWave + localNoise;
                    if (x === 0) ctx.moveTo(x, y);
                    else ctx.lineTo(x, y);
                }
                ctx.stroke();
                
                let accuracy = Math.max(0, 100 - noiseLevel);
                accuracyText.innerText = accuracy.toFixed(0);
                indicator.innerText = accuracy > 70 ? "Sinyal Audio Jernih" : (accuracy > 30 ? "Sinyal Terdistorsi (Noise)" : "Sinyal Rusak Parah!");
                indicator.className = accuracy > 40 ? "noise-status status-ok" : "noise-status status-error";
            } 
            else {
                eduTitle.innerText = "Karakteristik Sinyal Digital";
                eduText.innerText = "Sinyal digital memiliki sifat 'all-or-nothing'. Karena menggunakan ambang batas (threshold), data tetap bisa dipulihkan sempurna (100% akurasi) selama noise tidak terlalu ekstrem. Namun, jika noise melewati batas tertentu, data akan hancur total.";

                const bits = "10110100";
                const step = width / bits.length;
                let cx = 0;
                
                bits.split('').forEach((bit, i) => {
                    const baseY = bit === '1' ? height * 0.3 : height * 0.7;
                    drawBitLabel(ctx, bit, cx + step/2, height * 0.15);
                    
                    for(let sx = 0; sx < step; sx++) {
                        const x = cx + sx;
                        const localNoise = (x > width*0.3) ? (Math.random() - 0.5) * noiseIntensity * 15 : 0;
                        const y = baseY + localNoise;
                        if (x === 0) ctx.moveTo(x, y);
                        else ctx.lineTo(x, y);
                    }
                    cx += step;
                });
                ctx.stroke();

                if (noiseLevel < 65) {
                    indicator.innerText = "Data Diterima Akurat!";
                    indicator.className = "noise-status status-ok";
                    accuracyText.innerText = "100";
                } else {
                    indicator.innerText = "Data Rusak! Gagal Dekode.";
                    indicator.className = "noise-status status-error";
                    accuracyText.innerText = "0";
                }
            }
        }

    </script>
</body>
</html>